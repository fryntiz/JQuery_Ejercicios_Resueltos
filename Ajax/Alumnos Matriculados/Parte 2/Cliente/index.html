<!DOCTYPE html>
<!--
 @author Raúl Caro Pastorino
 @copyright Copyright © 2017 Raúl Caro Pastorino
 @license https://wwww.gnu.org/licenses/gpl.txt
-->

<!--
↓ INSTRUCCIONES DEL EJERCICIO ↓
Modifica la primera parte del ejercicio para que el usuario solicite los alumnos
de un curso concreto.

Ahora solo se mostrarán los alumnos correspondientes al curso introducido.
-->
<html lang="es">
<head>
    <meta charset="UTF-8" />
    <title>Ejercicios DOM Básicos</title>
    <script src="./jquery-3.3.1.js"></script>
    <script>
        window.onload = function() {
            // Añado evento al botón de ver cursos
            $('input[type="button"]').on('click', verCursos);

            /**
             * Esta función comprueba el valor introducido y muestra los cursos
             * si coincide.
             */
            function verCursos() {
                var curso = $('input[name="entrada"]').val().toLowerCase();

                if ((curso === '1daw') || (curso === '2daw')) {
                    pintarDatos(curso);
                } else {
                    console.log('El valor no coincide');
                }
            }

            /**
             * Realiza la petición para obtener los datos solo del curso deseado
             * @param curso
             */
            function pintarDatos(curso) {
                $('#boxResult').empty().append('<h2>' + curso + '</h2>');
                $.getJSON('../Servidor/consulta.php?curso=' + curso,
                 function (data) {
                    $.each(data, function (index, obj) {
                        console.log(obj);
                        $('#boxResult').append('<li>' +
                            'Nombre: ' + obj.nombre +
                            ' Dni: ' + obj.dni +
                            ' Acceso: ' + obj.acceso +
                            '</li>'
                        );
                    });
                });
            }
        }
    </script>
</head>

<body>
<form>
    <input name="entrada" type="text" /><input type="button" value="Ver Cursos">
</form>
<div id="boxResult"></div>
</body>
</html>
